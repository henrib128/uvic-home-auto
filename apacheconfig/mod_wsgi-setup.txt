# Setting up Apache2 and mod_wsgi
sudo apt-get install apache2 python-setuptools libapache2-mod-wsgi

# Modify apache2 configuration to include wsgi alias
# Note that we do not directly modify /etc/apache2/apache2.conf file (main conf file for apache2, equivalent to httpd.conf of apache)
# to avoid being overriden next update, but modify the /etc/apache2/sites-enabled/000-default instead
# By default, apache2.conf will include all conf in port.conf, conf.d, mods-enabled, and sites-enabled
cd /etc/apache2/sites-enabled
sudo gedit 000-default

# Add the follow WSGI Alias application script
#WSGIScriptAlias / /path/to/mysite.com/mysite/wsgi.py
WSGIScriptAlias / /var/www/pihome.wsgi
DocumentRoot /var/www

# Those are optional
#WSGIPythonPath /path/to/mysite.com
#WSGIDaemonProcess pywsgi:80 processes=2 threads=15 display-name=%{GROUP}
#WSGIProcessGroup pywsgi:80

# Enable wsgi mode (should be enabled already)
a2enmod wsgi

# Restart apache2
sudo /etc/init.d/apache2 restart

# Now added the /var/www/pihome.wsgi file so Apache2 now what to do according to that file
# Open browser and type localhost
#######################################################################################
import os
import sys

#sys.path.append('/srv/www/ducklington.org/application')

#os.environ['PYTHON_EGG_CACHE'] = '/srv/www/ducklington.org/.python-egg'

def application(environ, start_response):
    status = '200 OK'
    output = 'Hello Tri World!'

    response_headers = [('Content-type', 'text/plain'),
                        ('Content-Length', str(len(output)))]
    start_response(status, response_headers)

    return [output]
######################################################################################    
    

Another examlple with url request parsing
######################################################################################
"""
The WSGI script for our application.  It determines what other scripts need
to be run.
"""

import sys
import os
import os.path
import urlparse
import time
import threading

app_dir = os.path.dirname(__file__)
if app_dir not in sys.path:
    sys.path.append(app_dir)

#import logclient
#import tranclient
import socket

# Create singular socket connection to Log server for each Web-process
# This connection essentially creates one Log-thread for each web-process
#LogClient = logclient.LogClient()

# Create singular socket connection to Transaction server for each Web-process
# This connection essentially creates one Tran-thread for each web-process
#TranClient = tranclient.TranClient()

#semaphore = threading.Semaphore(1)

def abs_path(relative_path):
    """
    Get the absolute path for a path relative to this file.
    """
    return os.path.dirname(__file__) + os.sep + relative_path

def application(environ, start_response):
    #semaphore.acquire()

    # Determine what resource was requested
    request_path = environ["PATH_INFO"]
    sys.stderr.write("request_path: %s\n" % str(request_path))
    
    command = request_path[1:].upper()
    sys.stderr.write("command: %s\n" % str(command))
    
    # Get query parameters
    params = urlparse.parse_qs(environ["QUERY_STRING"])
    sys.stderr.write("params: %s\n" % str(params))
    
    # Try to extract out command parameters if existed, else assign empty string
    # Retrieve userid value
    try: userid = params["userid"][0]
    except KeyError: userid = ""
    # Retrieve stocksymbol value
    try: stocksymbol = params["stocksymbol"][0]
    except KeyError: stocksymbol = ""
    # Retrieve amount value
    try: amount = params["amount"][0]
    except KeyError: amount = ""
    # Retrieve filename value
    try: filename = params["filename"][0]
    except KeyError: filename = ""
    # Retrieve server hostname
    server=socket.gethostname()

    # Generic request template for transaction server including all possible parameter fields separated by ','
    tran_request = "%s,%s,%s,%s,%s" % (command, userid, stocksymbol, amount, filename)

    # Send logevent to logserver via logclient socket
    #LogClient.generate_user_command_log(time.time(), server, command, userid, stocksymbol, filename, amount)

    status = '200 OK'

    if command == "QUOTE":
        # Send logevent to logserver via logclient socket
        #LogClient.generate_user_command_log(time.time(), server, command, userid, stocksymbol, filename, amount)
        # Send generic transaction request to transerver via tranclient socket
        #TranClient.send(tran_request)
        sys.stderr.write("This is from QUOTE\n")

        output = '<b>This is QUO</b>'
        output = params.__str__()

    else:
        status = '404 Not Found'
        output = '<b>Page not found - Tri</b>'

    #semaphore.release()
    
    response_headers = [('Content-type', 'text/html'),
                        ('Content-Length', str(len(output)))]

    start_response(status, response_headers)
    return [output]
####################################################################################################################
    

